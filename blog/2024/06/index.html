<!DOCTYPE html><html class="no-js" lang="en"><head>
<meta charset="utf-8">
<meta content="width=device-width,initial-scale=1" name="viewport">
<meta content="A blog about Azure, DevOps and other stuff" name="description">
<meta content="Rafael Fernández" name="author">
<link href="https://rfernandezdo.github.io/blog/2024/06/" rel="canonical">
<link href="../09/" rel="prev">
<link href="../05/" rel="next">
<link href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=es&amp;_x_tr_hl=es&amp;_x_tr_pto=wapp" hreflang="en" rel="alternate">
<link href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=en&amp;_x_tr_pto=wapp" hreflang="es" rel="alternate">
<link href="../../../feed_rss_created.xml" rel="alternate" title="RSS feed" type="application/rss+xml">
<link href="../../../feed_rss_updated.xml" rel="alternate" title="RSS feed of updated content" type="application/rss+xml">
<link href="../../../assets/images/favicon.png" rel="icon">
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator">
<title>2024/06 - Un Rinconcito donde contar lo que quiera</title>
<link href="../../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet">
<link href="../../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet">
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet">
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<meta content="website" property="og:type">
<meta content="2024/06 - Un Rinconcito donde contar lo que quiera" property="og:title">
<meta content="A blog about Azure, DevOps and other stuff" property="og:description">
<meta content="https://rfernandezdo.github.io/assets/images/social/blog/2024/06.png" property="og:image">
<meta content="image/png" property="og:image:type">
<meta content="1200" property="og:image:width">
<meta content="630" property="og:image:height">
<meta content="https://rfernandezdo.github.io/blog/2024/06/" property="og:url">
<meta content="summary_large_image" property="twitter:card">
<meta content="2024/06 - Un Rinconcito donde contar lo que quiera" property="twitter:title">
<meta content="A blog about Azure, DevOps and other stuff" property="twitter:description">
<meta content="https://rfernandezdo.github.io/assets/images/social/blog/2024/06.png" property="twitter:image">
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox">
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox">
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#202406">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Un Rinconcito donde contar lo que quiera" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Un Rinconcito donde contar lo que quiera">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Un Rinconcito donde contar lo que quiera
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              2024/06
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio">
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio">
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Select language" class="md-header__button md-icon">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=es&amp;_x_tr_hl=es&amp;_x_tr_pto=wapp" hreflang="en">
              English
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=en&amp;_x_tr_pto=wapp" hreflang="es">
              Spanish
            </a>
</li>
</ul>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text">
<label class="md-search__icon md-icon" for="__search">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../">
          
  
  
  Blog

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        
  
  
    
  
  About

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../contributions/">
        
  
  
    
  
  Contributions

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../Azure/Security/MCSB/Readme/">
          
  
  
  Azure

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../Tools/Federated_Identity_Credentials_Report/README-federated-identity-credentials/">
          
  
  
  Tools

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Un Rinconcito donde contar lo que quiera" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Un Rinconcito donde contar lo que quiera">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Un Rinconcito donde contar lo que quiera
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox">
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
<span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tags/">
<span class="md-ellipsis">
    
  
    Posts by Tags
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1_3" type="checkbox">
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
<span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/12/">
<span class="md-ellipsis">
    
  
    2025/12
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/11/">
<span class="md-ellipsis">
    
  
    2025/11
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/10/">
<span class="md-ellipsis">
    
  
    2025/10
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/09/">
<span class="md-ellipsis">
    
  
    2025/09
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/08/">
<span class="md-ellipsis">
    
  
    2025/08
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/07/">
<span class="md-ellipsis">
    
  
    2025/07
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/06/">
<span class="md-ellipsis">
    
  
    2025/06
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/05/">
<span class="md-ellipsis">
    
  
    2025/05
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/04/">
<span class="md-ellipsis">
    
  
    2025/04
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/03/">
<span class="md-ellipsis">
    
  
    2025/03
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/02/">
<span class="md-ellipsis">
    
  
    2025/02
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2025/01/">
<span class="md-ellipsis">
    
  
    2025/01
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../12/">
<span class="md-ellipsis">
    
  
    2024/12
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11/">
<span class="md-ellipsis">
    
  
    2024/11
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10/">
<span class="md-ellipsis">
    
  
    2024/10
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../09/">
<span class="md-ellipsis">
    
  
    2024/09
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox">
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    2024/06
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    2024/06
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#when-to-use-service-principals">
<span class="md-ellipsis">
      
        When to use service principals
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microsoft-entra-conditional-access">
<span class="md-ellipsis">
      
        Microsoft Entra Conditional Access
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-threat-modeling-in-azure-storage-accounts">
<span class="md-ellipsis">
      
        Data threat modeling in Azure storage accounts
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tagging-best-practices-in-azure">
<span class="md-ellipsis">
      
        Tagging best practices in Azure
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#restrict-managed-disks-from-being-imported-or-exported">
<span class="md-ellipsis">
      
        Restrict managed disks from being imported or exported
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microsoft-entra-id-privileged-identity-management">
<span class="md-ellipsis">
      
        Microsoft Entra ID Privileged Identity Management
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway">
<span class="md-ellipsis">
      
        Securely connect Power BI to data sources with a VNet data gateway
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementing-policy-as-code-with-open-policy-agent">
<span class="md-ellipsis">
      
        Implementing policy as code with Open Policy Agent
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#finops-for-azure-optimizing-your-cloud-spend">
<span class="md-ellipsis">
      
        FinOps for Azure: Optimizing Your Cloud Spend
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05/">
<span class="md-ellipsis">
    
  
    2024/05
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../04/">
<span class="md-ellipsis">
    
  
    2024/04
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../03/">
<span class="md-ellipsis">
    
  
    2024/03
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02/">
<span class="md-ellipsis">
    
  
    2024/02
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023/12/">
<span class="md-ellipsis">
    
  
    2023/12
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023/11/">
<span class="md-ellipsis">
    
  
    2023/11
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023/10/">
<span class="md-ellipsis">
    
  
    2023/10
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_4" type="checkbox">
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
<span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure/">
<span class="md-ellipsis">
    
  
    Azure
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-ad/">
<span class="md-ellipsis">
    
  
    Azure AD
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-automation/">
<span class="md-ellipsis">
    
  
    Azure Automation
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-devops/">
<span class="md-ellipsis">
    
  
    Azure DevOps
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-frameworks/">
<span class="md-ellipsis">
    
  
    Azure Frameworks
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-governance/">
<span class="md-ellipsis">
    
  
    Azure Governance
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-networking/">
<span class="md-ellipsis">
    
  
    Azure Networking
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-security/">
<span class="md-ellipsis">
    
  
    Azure Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-services/">
<span class="md-ellipsis">
    
  
    Azure Services
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/azure-updates/">
<span class="md-ellipsis">
    
  
    Azure Updates
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/caf/">
<span class="md-ellipsis">
    
  
    CAF
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/cicd/">
<span class="md-ellipsis">
    
  
    CI/CD
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/devops/">
<span class="md-ellipsis">
    
  
    DevOps
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/development/">
<span class="md-ellipsis">
    
  
    Development
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/drift-detection/">
<span class="md-ellipsis">
    
  
    Drift Detection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/english/">
<span class="md-ellipsis">
    
  
    English
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/enterprise-policy-as-code/">
<span class="md-ellipsis">
    
  
    Enterprise Policy as Code
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/finops/">
<span class="md-ellipsis">
    
  
    FinOps
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/firewall/">
<span class="md-ellipsis">
    
  
    Firewall
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/gtd/">
<span class="md-ellipsis">
    
  
    GTD
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/git/">
<span class="md-ellipsis">
    
  
    Git
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/github-actions/">
<span class="md-ellipsis">
    
  
    GitHub Actions
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/hashicorp/">
<span class="md-ellipsis">
    
  
    HashiCorp
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/hello_world/">
<span class="md-ellipsis">
    
  
    Hello_World
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/infrastructure-as-code/">
<span class="md-ellipsis">
    
  
    Infrastructure as Code
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/learning/">
<span class="md-ellipsis">
    
  
    Learning
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/m365/">
<span class="md-ellipsis">
    
  
    M365
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/microsoft-365/">
<span class="md-ellipsis">
    
  
    Microsoft 365
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/microsoft-entra/">
<span class="md-ellipsis">
    
  
    Microsoft Entra
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/microsoft-entra-external-id/">
<span class="md-ellipsis">
    
  
    Microsoft Entra External ID
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/microsoft-entra-id/">
<span class="md-ellipsis">
    
  
    Microsoft Entra ID
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/networking/">
<span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/outlook/">
<span class="md-ellipsis">
    
  
    Outlook
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/pim/">
<span class="md-ellipsis">
    
  
    PIM
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/power-automate/">
<span class="md-ellipsis">
    
  
    Power Automate
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/power-bi/">
<span class="md-ellipsis">
    
  
    Power BI
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/productividad/">
<span class="md-ellipsis">
    
  
    Productividad
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/productividad--microsoft-365/">
<span class="md-ellipsis">
    
  
    Productividad / Microsoft 365
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/security/">
<span class="md-ellipsis">
    
  
    Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/seguridad/">
<span class="md-ellipsis">
    
  
    Seguridad
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/snowflake/">
<span class="md-ellipsis">
    
  
    Snowflake
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/terraform/">
<span class="md-ellipsis">
    
  
    Terraform
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/threat-intelligence/">
<span class="md-ellipsis">
    
  
    Threat Intelligence
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/tools/">
<span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/troubleshooting/">
<span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/visual-studio-code/">
<span class="md-ellipsis">
    
  
    Visual Studio Code
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/viva-insights/">
<span class="md-ellipsis">
    
  
    Viva Insights
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../category/windows/">
<span class="md-ellipsis">
    
  
    Windows
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    
  
    About
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contributions/">
<span class="md-ellipsis">
    
  
    Contributions
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox">
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Azure
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Azure
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1" type="checkbox">
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Security
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1_1" type="checkbox">
<label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    MCSB v1
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_1_1">
<span class="md-nav__icon md-icon"></span>
            
  
    MCSB v1
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Readme/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Readme
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Asset%20Management/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Asset Management
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Backup%20and%20Recovery/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Backup and Recovery
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Data%20Protection/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Data Protection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/DevOps%20Security/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - DevOps Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Endpoint%20Security/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Endpoint Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Governance%20and%20Strategy/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Governance and Strategy
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Identity%20Management/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Identity Management
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Incident%20Response/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Incident Response
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Logging%20and%20Threat%20Detection/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Logging and Threat Detection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Network%20Security/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Network Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Posture%20and%20Vulnerability%20Mgmt/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Posture and Vulnerability Mgmt
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSB/Privileged%20Access/">
<span class="md-ellipsis">
    
  
    MCSB_v1 - Privileged Access
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1_2" type="checkbox">
<label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    MCSB v2
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_1_2">
<span class="md-nav__icon md-icon"></span>
            
  
    MCSB v2
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Index/">
<span class="md-ellipsis">
    
  
    Microsoft Cloud Security Benchmark v2
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Network%20Security/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Network Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Identity%20Management/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Identity Management
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Privileged%20Access/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Privileged Access
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Data%20Protection/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Data Protection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Asset%20Management/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Asset Management
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Logging%20and%20Threat%20Detection/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Logging and Threat Detection
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Incident%20Response/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Incident Response
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Posture%20and%20Vulnerability%20Manag/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Posture and Vulnerability Manag
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Endpoint%20Security/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Endpoint Security
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Backup%20and%20Recovery/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Backup and Recovery
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Azure/Security/MCSBv2/Artificial%20Intelligence%20Securit/">
<span class="md-ellipsis">
    
  
    MCSB v2 - Artificial Intelligence Securit
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox">
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_1" type="checkbox">
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Federated Identity Credentials Report
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Federated Identity Credentials Report
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tools/Federated_Identity_Credentials_Report/README-federated-identity-credentials/">
<span class="md-ellipsis">
    
  
    Script de Reporte para Federated Identity Credentials
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_2" type="checkbox">
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Analyze Virtual Network Flows
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Analyze Virtual Network Flows
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tools/Analyze_Virtual_Network_Flows/">
<span class="md-ellipsis">
    
  
    Analyze-VNETFlowLogs
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<div class="md-content__inner">
<header class="md-typeset">
<h1 id="202406">2024/06</h1>
</header>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-18 00:00:00+00:00">June 18, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/microsoft-entra/">Microsoft Entra</a></li>
<li class="md-meta__item">
            
              1 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="when-to-use-service-principals"><a class="toclink" href="18/when-to-use-service-principals/">When to use service principals</a></h2>
<p>In Azure, there are two ways to authenticate your applications and services: service principals and managed identities. </p>
<p>Basically, <strong>don't use service principals if you can use managed identities</strong>. Managed identities are a more secure way to authenticate your applications and services in Azure. However, there are some scenarios where you need to use service principals instead of managed identities. Here are some scenarios where you should use service principals:</p>
<pre class="mermaid"><code>flowchart TD
    A[When to use service principals] --&gt; B{Is your application or service running on-premises?}
    B --&gt; |Yes| C{Is Azure Arc supported?}
    C --&gt; |Yes| D[Use Managed Identity]
    C --&gt; |No| E[Use Service Principal]
    B --&gt; |No| F{Do the resources or applications support managed identities?}
    F --&gt; |No| G[Use Service Principal]
    F --&gt; |Yes| H[Use Managed Identity]
</code></pre>
<h3 id="conclusion"><a class="toclink" href="18/when-to-use-service-principals/#conclusion">Conclusion</a></h3>
<p>In conclusion, you should use managed identities whenever possible. However, if your application or service is running on-premises or if the resources or applications do not support managed identities, you should use service principals instead.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-17 00:00:00+00:00">June 17, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/microsoft-entra/">Microsoft Entra</a></li>
<li class="md-meta__item">
            
              6 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="microsoft-entra-conditional-access"><a class="toclink" href="17/microsoft-entra-conditional-access/">Microsoft Entra Conditional Access</a></h2>
<p>In this post, I will show you how to configure Conditional Access in Microsoft Entra.</p>
<h3 id="what-is-conditional-access"><a class="toclink" href="17/microsoft-entra-conditional-access/#what-is-conditional-access">What is Conditional Access?</a></h3>
<p>Conditional Access is a feature of Microsoft Entra that allows you to control access to your organization's resources based on specific conditions. With Conditional Access, you can enforce policies that require users to meet certain criteria before they can access resources, such as multi-factor authentication, device compliance, or location-based restrictions.</p>
<p>You have three main components in Conditional Access:</p>
<ul>
<li><strong>Signals</strong>: These are the conditions that trigger a policy. Signals can include user sign-in, device state, location, and more.</li>
<li><strong>Decisions</strong>: These are the actions that are taken when a policy is triggered. Decisions can include requiring multi-factor authentication, blocking access, or granting access with conditions.</li>
<li><strong>Enforcement</strong>: This is the mechanism that enforces the policy. Enforcement can be done at the application level, the network level, or the device level.</li>
</ul>
<p>Really, all the Conditional Access policies are based on the following flow:</p>
<ol>
<li><strong>Assignments</strong>: Define who and where the policy applies to.</li>
<li><strong>Access Controls</strong>: Define what to do when the the who and where are met.</li>
</ol>
<p>For that reason, we can define the followin phases:</p>
<ul>
<li><strong>Phase 1</strong>: Collect session details</li>
<li>
<p><strong>Assignments</strong>: Define who and where the policy applies to.    </p>
<ul>
<li><strong>users</strong>: users and groups selected and excluded</li>
<li><strong>Target resources</strong>: Control access base on Cloud apps, actions, and authentication context.</li>
<li><strong>Cloud apps</strong>: Include and exclude. Many of the existing Microsoft cloud applications are included in the list of applications that can be targeted by Conditional Access policies:  Office 365, Windows Azure Service Management API, Microsoft Admin Portals and Others</li>
<li><strong>User actions</strong>: Tasks that a user performs: Register security information and Register or join devices</li>
<li><strong>Global Secure Access</strong>: Targeting members in your tenant with Global Secure Access (GSA) as a resource,enable administrators to define and control how traffic is routed through Microsoft Entra Internet Access and Microsoft Entra Private Access.</li>
<li><strong>Authentication context</strong>: With this option you can define a authentication context for the policy, for example, you can define that the policy is applied only when the user is accessing to Higly Confidential information. You can create labels with ID c1 to c99 and tag your information with these labels. Not all apps support authentication contexts, you can check the <a href="https://learn.microsoft.com/en-us/purview/sensitivity-labels-teams-groups-sites#more-information-about-the-dependencies-for-the-authentication-context-option">official documentation</a> to see which apps support it.</li>
<li><strong>Network</strong>: Include and Exclude. Control user access based on their network location or physical location.<ul>
<li><strong>Any network or location</strong>: This option allows you to apply the policy to all network locations.</li>
<li><strong>All trusted locations</strong>: This option allows you to apply the policy to all trusted locations.</li>
<li><strong>All Compliant Network locations</strong>: This option allows you to apply the policy to all compliant network locations.</li>
<li><strong>Selected network or location</strong>: This option allows you to apply the policy to selected network locations: Countries(GPS),Countries(IP) and IP ranges.</li>
</ul>
</li>
<li><strong>Conditions</strong>: Control access based in signals from conditions.<ul>
<li><strong>User risk</strong>: Control access based on the user risk level calculated by Microsoft Entra Identity Protection. User risk represents the probability that a given identity or account is compromised, for example: Published credentials in Dark Web.</li>
<li><strong>Sign-in risk</strong>: Control access based on the sign-in risk level calculated by Microsoft Entra Identity Protection. Sign-in risk represents the probability that a given authentication request wasn't made by the identity owner. For example, sign-in from a new location or new device.</li>
<li><strong>Insider risk</strong>: Control access for users who are assigned specific risk levels from Adaptive Protection, a Microsoft Purview Insider Risk Management feature. Insider risk represents the probability that a given user is engaged in risky data-related activities.</li>
<li><strong>Device Platform</strong>: Include and Exclude. Control access based on the platform of the device used to sign in.</li>
<li><strong>Client apps</strong>: Include and Exclude. Control access based on the client apps used to sign in.</li>
<li><strong>Filters for devices</strong>: Include and Exclude. Control access based on configured filters to apply policy to specific devices</li>
<li><strong>Authentication flows</strong>: Control access based on the authentication flow used to sign in: </li>
<li>Device code flow: Device code flow is a method of authentication that allows users to sign in to a device using a code displayed on the device. This flow is used for devices that don't have a browser or can't use a browser to sign in.</li>
<li>Authentication transfer: Authentication transfer is a new flow that offers a seamless way to transfer authenticated state from one device to another.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Phase 2</strong>: Enforcement</p>
</li>
<li><strong>Access controls</strong>: Define what to do when the the who and where are met.<ul>
<li><strong>Grant</strong>: Control access enforcement to block or grant access.</li>
<li><strong>Block</strong>: Block access to the resource.</li>
<li><strong>Grant</strong>: Grant access to the resource. You can also define the following options:<ul>
<li><strong>Require multi-factor authentication</strong>: Require users to perform multi-factor authentication.</li>
<li><strong>Require authentication strength</strong>:  Require a combination of authentication methods to access the resource.</li>
<li><strong>Require device to be marked as compliant</strong>: Require the device to be marked as compliant by Microsoft Entra Intune.</li>
<li><strong>Require Hybrid Azure AD joined device</strong>: Require the device to be Hybrid Azure AD joined.</li>
<li><strong>Require approved client app</strong>: Require the use of an approved client app.</li>
<li><strong>Require app protection policy</strong>: Require that an Intune app protection policy is present on the client app before access is available to the selected applications</li>
<li><strong>Require password change</strong>: Require the user to change their password.</li>
</ul>
</li>
<li>For multiple controls, you can define the following options:<ul>
<li><strong>Require all the selected controls</strong>: Require all the selected controls to be met.</li>
<li><strong>Require one of the selected controls</strong>: Require one of the selected controls to be met.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Session</strong>: Control access based on session controls to enable limited experiences within specific cloud applications.<ul>
<li><strong>Use app enforced restrictions</strong>: Enforce app restrictions to control access based on the app's own restrictions. When selected, the cloud app uses the device information to provide users with a limited or full experience. Limited when the device isn't managed or compliant and full when the device is managed and compliant.</li>
<li><strong>Use Conditional Access App Control</strong>: Enforce real-time monitoring and control of user sessions. Conditional Access App Control enables user app access and sessions to be monitored and controlled in real time based on access and session policies. Access and session policies are used within the Defender for Cloud Apps portal to refine filters and set actions to take.</li>
<li><strong>Sign-in frequency</strong>: Enforce sign-in frequency to control how often users are prompted to sign in. Sign-in frequency setting works with apps that implement OAUTH2 or OIDC protocols according to the standards.</li>
<li><strong>Persistent browser session</strong>: Enforce persistent browser session to control users can remain signed in after closing and reopening their browser window.</li>
<li><strong>Customize continuous access evaluation</strong>: Enable custom continuous access evaluation to revoke access tokens based on critical events and policy evaluation in real time.Continuous Access Evaluation (CAE) allows access tokens to be revoked based on critical events and policy evaluation in real time rather than relying on token expiration based on lifetime.</li>
</ul>
</li>
</ul>
<p>Example of Conditional Access policy configuration:</p>
<ol>
<li><strong>Block access to all users from all locations except for a specific group of users from a specific location</strong>:</li>
<li><strong>Assignments</strong>:<ul>
<li><strong>users</strong>: </li>
<li>Include:All users</li>
<li>Exclude: Group_of_excluded_users</li>
<li><strong>Target resources</strong>:</li>
<li><strong>Cloud apps</strong>: All cloud apps</li>
<li><strong>Network</strong>: All trusted locations</li>
</ul>
</li>
<li><strong>Access controls</strong>:<ul>
<li><strong>Grant</strong>: Block</li>
</ul>
</li>
</ol>
<p>Mindmaps of the Conditional Access policies flow:</p>
<pre class="language-markmap"><code># Conditional Access Policy
## Phase 1: Collect session details
### Assignments
#### users
##### Include
###### None
###### All users
###### Select users and groups
##### Exclude
###### Guest or external users
###### Directory roles
###### Users and groups
#### Target resources
##### Cloud apps
###### Include
 - None
 - All cloud apps
 - Select apps
###### Exclude
  - Edit Filter
  - Select excluded cloud apps
##### User actions
  - Register security information
  - Register or join devices
##### Global Secure Access
  - Microsoft 365 traffic
  - Internet traffic
  - Private traffic
##### Authentication context
##### Network
###### Any network or location
###### All trusted locations
###### All Compliant Network locations
###### Selected network or location
#### Conditions
##### User risk
##### Sign-in risk
##### Insider risk
##### Device Platform
##### Client apps
##### Filters for devices
##### Authentication flows
###### Device code flow
###### Authentication transfer
## Phase 2: Enforcement
### Access controls
#### Grant
##### Block
##### Grant
###### Require multi-factor authentication
###### Require authentication strength
###### Require device to be marked as compliant
###### Require Hybrid Azure AD joined device
###### Require approved client app
###### Require app protection policy
###### Require password change
##### For multiple controls
###### Require all the selected controls
###### Require one of the selected controls
#### Session
##### Use app enforced restrictions
##### Use Conditional Access App Control
##### Sign-in frequency
##### Persistent browser session
##### Customize continuous access evaluation</code></pre>
<pre class="mermaid"><code>mindmap
    root((Conditional Access Policy))
      (Phase 1: Collect session details)
        (Assignments)        
          [users]
            {{Include}}
              None
              All users
              Select users and groups
            {{Exclude}}
              Guest or external users
              Directory roles
              Users and groups
          [Target resources]
            {{Cloud apps}}
              Include
                None
                All cloud apps
                Select apps
              Exclude
                Edit Filter
                Select excluded cloud apps
            {{User actions}}
              Register security information
              Register or join devices
            {{Global Secure Access}}
              Microsoft 365 traffic
              Internet traffic
              Private traffic
            {{Authentication context}}
            {{Network}}
              Any network or location
              All trusted locations
              All Compliant Network locations
              Selected network or location
          [Conditions]
            {{User risk}}
            {{Sign-in risk}}
            {{Insider risk}}
            {{Device Platform}}
            {{Client apps}}
            {{Filters for devices}}
            {{Authentication flows}}
              Device code flow
              Authentication transfer
      (Phase 2: Enforcement)
        (Access controls)
          [Grant]
            {{Block}}
            {{Grant}}
              Require multi-factor authentication
              Require authentication strength
              Require device to be marked as compliant
              Require Hybrid Azure AD joined device
              Require approved client app
              Require app protection policy
              Require password change
            {{For multiple controls}}
              Require all the selected controls
              Require one of the selected controls
          [Session]
            {{Use app enforced restrictions}}
            {{Use Conditional Access App Control}}
            {{Sign-in frequency}}
            {{Persistent browser session}}
            {{Customize continuous access evaluation}}
</code></pre>
<h3 id="resources"><a class="toclink" href="17/microsoft-entra-conditional-access/#resources">Resources</a></h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview">Conditional Access documentation</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-16 00:00:00+00:00">June 16, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/azure-services/">Azure Services</a></li>
<li class="md-meta__item">
            
              11 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="data-threat-modeling-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/">Data threat modeling in Azure storage accounts</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>I apologize in advance if this is a crazy idea and there is some mistake!! I am just trying to learn and share knowledge.</p>
</div>
<p>Azure Storage Account is a service that provides scalable, secure, and reliable storage for data. It is used to store data such as blobs, files, tables, and queues. However, it is important to ensure that the data stored in Azure Storage Account is secure and protected from security threats. In this article, we will discuss how to perform data threat modeling in Azure storage accounts.</p>
<h3 id="what-is-data-threat-modeling"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#what-is-data-threat-modeling">What is data threat modeling?</a></h3>
<p>Data threat modeling is a process of identifying and analyzing potential threats to data security. It helps organizations understand the risks to their data and develop strategies to mitigate those risks. Data threat modeling involves the following steps:</p>
<ol>
<li><strong>Identify assets</strong>: Identify the data assets stored in Azure storage accounts, such as blobs, files, tables, and queues.</li>
<li><strong>Identify threats</strong>: Identify potential threats to the data assets, such as unauthorized access, data breaches, data leakage, malware, phishing attacks, insider threats, and data loss.</li>
<li><strong>Assess risks</strong>: Assess the risks associated with each threat, such as the likelihood of the threat occurring and the impact of the threat on the data assets.</li>
<li><strong>Develop mitigation strategies</strong>: Develop strategies to mitigate the risks, such as implementing security controls, access controls, encryption, monitoring, and auditing.</li>
</ol>
<p>By performing data threat modeling, organizations can identify and address security vulnerabilities in Azure storage accounts and protect their data from security threats.</p>
<h3 id="identify-assets-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#identify-assets-in-azure-storage-accounts">Identify assets in Azure storage accounts</a></h3>
<p>Azure storage accounts can store various types of data assets, including:</p>
<ul>
<li><strong>Blobs</strong>: Binary large objects (blobs) are used to store unstructured data, such as images, videos, and documents.</li>
<li><strong>Files</strong>: Files are used to store structured data, such as text files, configuration files, and log files.</li>
<li><strong>Tables</strong>: Tables are used to store structured data in a tabular format, such as customer information, product information, and transaction data.</li>
<li><strong>Queues</strong>: Queues are used to store messages for communication between applications, such as task messages, notification messages, and status messages.</li>
<li><strong>Disks</strong>: Disks are used to store virtual machine disks, such as operating system disks and data disks.</li>
</ul>
<p>Identifying the data assets stored in Azure storage accounts is the first step in data threat modeling. It helps organizations understand the types of data stored in Azure storage accounts and the potential risks to those data assets.</p>
<h3 id="identify-threats-to-data-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#identify-threats-to-data-in-azure-storage-accounts">Identify threats to data in Azure storage accounts</a></h3>
<p>There are several threats to data stored in Azure storage accounts, including:</p>
<ul>
<li><strong>Unauthorized access</strong>: Unauthorized users gaining access to Azure storage accounts and stealing data.</li>
<li><strong>Data breaches</strong>: Data breaches can expose sensitive data stored in Azure storage accounts.</li>
<li><strong>Data leakage</strong>: Data leakage can occur due to misconfigured access controls or insecure data transfer protocols.</li>
<li><strong>Data loss</strong>: Data loss can occur due to accidental deletion, corruption, or hardware failure.</li>
<li><strong>Ransomware</strong>: Ransomware can encrypt data stored in Azure storage accounts and demand a ransom for decryption.</li>
<li><strong>DDoS attacks</strong>: DDoS attacks can disrupt access to data stored in Azure storage accounts.</li>
<li><strong>Phishing attacks</strong>: Phishing attacks can trick users into providing their login credentials, which can be used to access and steal data.</li>
<li><strong>Malware</strong>: Malware can be used to steal data from Azure storage accounts and transfer it to external servers.</li>
<li><strong>Insider threats</strong>: Employees or contractors with access to sensitive data may intentionally or unintentionally exfiltrate data.</li>
<li><strong>Data exfiltration</strong>: Unauthorized transfer of data from Azure storage accounts to external servers.</li>
</ul>
<p>For example, the flow of data exfiltration in Azure storage accounts can be summarized as follows:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Azure Storage Account
    participant External Server

    User-&gt;&gt;Azure Storage Account: Upload data
    Azure Storage Account-&gt;&gt;External Server: Unauthorized transfer of data
</code></pre>
<p>In this flow, the user uploads data to the Azure Storage Account, and the data is then transferred to an external server without authorization. This unauthorized transfer of data is known as data exfiltration.</p>
<h3 id="assess-risks-to-data-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#assess-risks-to-data-in-azure-storage-accounts">Assess risks to data in Azure storage accounts</a></h3>
<p>Assessing the risks associated with threats to data in Azure storage accounts is an important step in data threat modeling. Risks can be assessed based on the likelihood of the threat occurring and the impact of the threat on the data assets. Risks can be categorized as low, medium, or high based on the likelihood and impact of the threat.</p>
<p>For example, the risk of unauthorized access to Azure storage accounts may be categorized as high if the likelihood of unauthorized access is high and the impact of unauthorized access on the data assets is high. Similarly, the risk of data leakage may be categorized as medium if the likelihood of data leakage is medium and the impact of data leakage on the data assets is medium.</p>
<p>By assessing risks to data in Azure storage accounts, organizations can prioritize security measures and develop strategies to mitigate the risks.</p>
<p>For example, the risk of data exfiltration in Azure storage accounts can be assessed as follows:</p>
<pre class="mermaid"><code>pie
    title Data Exfiltration Risk Assessment
    "Unauthorized Access" : 30
    "Data Breaches" : 20
    "Data Leakage" : 15
    "Malware" : 10
    "Phishing Attacks" : 10
    "Insider Threats" : 15
</code></pre>
<h3 id="develop-mitigation-strategies-for-data-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#develop-mitigation-strategies-for-data-in-azure-storage-accounts">Develop mitigation strategies for data in Azure storage accounts</a></h3>
<p>Developing mitigation strategies is an essential step in data threat modeling. Mitigation strategies help organizations protect their data assets from security threats and reduce the risks associated with those threats. Mitigation strategies could include the following:</p>
<ol>
<li><strong>Implement access controls</strong>: Implement access controls to restrict access to Azure storage accounts based on user roles and permissions.</li>
<li><strong>Encrypt data</strong>: Encrypt data stored in Azure storage accounts to protect it from unauthorized access.</li>
<li><strong>Monitor and audit access</strong>: Monitor and audit access to Azure storage accounts to detect unauthorized access and data exfiltration.</li>
<li><strong>Implement security controls</strong>: Implement security controls, such as firewalls, network security groups, and intrusion detection systems, to protect data in Azure storage accounts.</li>
<li><strong>Use secure transfer protocols</strong>: Use secure transfer protocols, such as HTTPS, to transfer data to and from Azure storage accounts.</li>
<li><strong>Implement multi-factor authentication</strong>: Implement multi-factor authentication to protect user accounts from unauthorized access.</li>
<li><strong>Train employees</strong>: Train employees on data security best practices to prevent data exfiltration and other security threats.</li>
<li><strong>Backup data</strong>: Backup data stored in Azure storage accounts to prevent data loss due to accidental deletion or corruption.</li>
<li><strong>Update software</strong>: Keep software and applications up to date to protect data stored in Azure storage accounts from security vulnerabilities.</li>
<li><strong>Implement data loss prevention (DLP) policies</strong>: Implement DLP policies to prevent data leakage and unauthorized transfer of data from Azure storage accounts.</li>
</ol>
<p>As it is not an easy task, Microsoft provides us with tools for this, in the case of using a security framework we can always use the MCSB (Microsoft Cloud Security Baseline) which is a set of guidelines and best practices for securing Azure services, including Azure storage accounts. The MCSB provides recommendations for securing Azure storage accounts, such as enabling encryption, implementing access controls, monitoring access, and auditing activities:</p>
<table>
<thead>
<tr>
<th>Control Domain</th>
<th>ASB Control ID</th>
<th>ASB Control Title</th>
<th>Responsibility</th>
<th>Feature Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Asset Management</td>
<td>AM-2</td>
<td>Use only approved services</td>
<td>Customer</td>
<td>Azure Policy Support</td>
</tr>
<tr>
<td>Backup and recovery</td>
<td>BR-1</td>
<td>Ensure regular automated backups</td>
<td>Customer</td>
<td>Azure Backup</td>
</tr>
<tr>
<td>Backup and recovery</td>
<td>BR-1</td>
<td>Ensure regular automated backups</td>
<td>Customer</td>
<td>Service Native Backup Capability</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-1</td>
<td>Discover, classify, and label sensitive data</td>
<td>Customer</td>
<td>Sensitive Data Discovery and Classification</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-2</td>
<td>Monitor anomalies and threats targeting sensitive data</td>
<td>Customer</td>
<td>Data Leakage/Loss Prevention</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-3</td>
<td>Encrypt sensitive data in transit</td>
<td>Microsoft</td>
<td>Data in Transit Encryption</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-4</td>
<td>Enable data at rest encryption by default</td>
<td>Microsoft</td>
<td>Data at Rest Encryption Using Platform Keys</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-5</td>
<td>Use customer-managed key option in data at rest encryption when required</td>
<td>Customer</td>
<td>Data at Rest Encryption Using CMK</td>
</tr>
<tr>
<td>Data Protection</td>
<td>DP-6</td>
<td>Use a secure key management process</td>
<td>Customer</td>
<td>Key Management in Azure Key Vault</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-1</td>
<td>Use centralized identity and authentication system</td>
<td>Microsoft</td>
<td>Azure AD Authentication Required for Data Plane Access</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-1</td>
<td>Use centralized identity and authentication system</td>
<td>Customer</td>
<td>Local Authentication Methods for Data Plane Access</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-3</td>
<td>Manage application identities securely and automatically</td>
<td>Customer</td>
<td>Managed Identities</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-3</td>
<td>Manage application identities securely and automatically</td>
<td>Customer</td>
<td>Service Principals</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-7</td>
<td>Restrict resource access based on conditions</td>
<td>Customer</td>
<td>Conditional Access for Data Plane</td>
</tr>
<tr>
<td>Identity Management</td>
<td>IM-8</td>
<td>Restrict the exposure of credential and secrets</td>
<td>Customer</td>
<td>Service Credential and Secrets Support Integration and Storage in Azure Key Vault</td>
</tr>
<tr>
<td>Logging and threat detection</td>
<td>LT-1</td>
<td>Enable threat detection capabilities</td>
<td>Customer</td>
<td>Microsoft Defender for Service / Product Offering</td>
</tr>
<tr>
<td>Logging and threat detection</td>
<td>LT-4</td>
<td>Enable network logging for security investigation</td>
<td>Customer</td>
<td>Azure Resource Logs</td>
</tr>
<tr>
<td>Network Security</td>
<td>NS-2</td>
<td>Secure cloud services with network controls</td>
<td>Customer</td>
<td>Disable Public Network Access</td>
</tr>
<tr>
<td>Network Security</td>
<td>NS-2</td>
<td>Secure cloud services with network controls</td>
<td>Customer</td>
<td>Azure Private Link</td>
</tr>
<tr>
<td>Privileged Access</td>
<td>PA-7</td>
<td>Follow just enough administration(least privilege) principle</td>
<td>Customer</td>
<td>Azure RBAC for Data Plane</td>
</tr>
<tr>
<td>Privileged Access</td>
<td>PA-8</td>
<td>Choose approval process for third-party support</td>
<td>Customer</td>
<td>Customer Lockbox</td>
</tr>
</tbody>
</table>
<p>And part of MCSB can be complemented with Azure Well Architected Framework, which provides guidance on best practices for designing and implementing secure, scalable, and reliable cloud solutions. The Well Architected Framework includes security best practices for Azure storage accounts, such as implementing security controls, access controls, encryption, monitoring, and auditing:</p>
<ol>
<li><strong>Enable Azure Defender for all your storage accounts</strong>: Azure Defender for Storage provides advanced threat protection for Azure storage accounts. It helps detect and respond to security threats in real-time.</li>
<li><strong>Turn on soft delete for blob data</strong>: Soft delete helps protect your blob data from accidental deletion. It allows you to recover deleted data within a specified retention period.</li>
<li><strong>Use Microsoft Entitlement Management to authorize access to blob data</strong>: Microsoft Entitlement Management provides fine-grained access control for Azure storage accounts. It allows you to define and enforce access policies based on user roles and permissions.</li>
<li><strong>Consider the principle of least privilege</strong>: When assigning permissions to a Microsoft Entitlement security principal through Azure RBAC, follow the principle of least privilege. Only grant the minimum permissions required to perform the necessary tasks.</li>
<li><strong>Use managed identities to access blob and queue data</strong>: Managed identities provide a secure way to access Azure storage accounts without storing credentials in your code.</li>
<li><strong>Use blob versioning or immutable blobs</strong>: Blob versioning and immutable blobs help protect your business-critical data from accidental deletion or modification.</li>
<li><strong>Restrict default internet access for storage accounts</strong>: Limit default internet access to Azure storage accounts to prevent unauthorized access.</li>
<li><strong>Enable firewall rules</strong>: Use firewall rules to restrict network access to Azure storage accounts. Only allow trusted IP addresses to access the storage account.</li>
<li><strong>Limit network access to specific networks</strong>: Limit network access to specific networks or IP ranges to prevent unauthorized access.</li>
<li><strong>Allow trusted Microsoft services to access the storage account</strong>: Allow only trusted Microsoft services to access the storage account to prevent unauthorized access.</li>
<li><strong>Enable the Secure transfer required option</strong>: Enable the Secure transfer required option on all your storage accounts to enforce secure connections.</li>
<li><strong>Limit shared access signature (SAS) tokens to HTTPS connections only</strong>: Limit shared access signature (SAS) tokens to HTTPS connections only to prevent unauthorized access.</li>
<li><strong>Avoid using Shared Key authorization</strong>: Avoid using Shared Key authorization to access storage accounts. Use Azure AD or SAS tokens instead.</li>
<li><strong>Regenerate your account keys periodically</strong>: Regenerate your account keys periodically to prevent unauthorized access.</li>
<li><strong>Create a revocation plan for SAS tokens</strong>: Create a revocation plan and have it in place for any SAS tokens that you issue to clients. This will help you revoke access to the storage account if necessary.</li>
<li><strong>Use near-term expiration times on SAS tokens</strong>: Use near-term expiration times on impromptu SAS, service SAS, or account SAS to limit the exposure of the token.</li>
</ol>
<h3 id="mixed-strategies-for-data-protection-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#mixed-strategies-for-data-protection-in-azure-storage-accounts">Mixed strategies for data protection in Azure storage accounts</a></h3>
<p>Diagram of the mixed strategies for data protection in Azure storage accounts:</p>
<pre class="mermaid"><code>graph LR
    A[Asset Management] --&gt;B(AM-2)
    B --&gt; C[Use only approved services]
    C --&gt; D[Azure Policy] 
    E[Backup and recovery] --&gt;F(BR-1)
    F --&gt; G[Ensure regular automated backups]
    G --&gt; H[Azure Backup]
    G --&gt; I[Service Native Backup Capability]
    I --&gt; I1["Azure Storage Account Configuration"]
    I1 --&gt; I11["Turn on soft delete for blob data"]
    I1 --&gt; I12["Use blob versioning or immutable blobs"]
</code></pre>
<pre class="mermaid"><code>graph LR
    J[Data Protection] --&gt;K(DP-1)
    K --&gt; L[Discover, classify, and label sensitive data]    
    L --&gt; M[Sensitive Data Discovery and Classification]
    M --&gt; M1["Microsoft Pureview"]       
    J --&gt; N(DP-2)
    N --&gt; O[Monitor anomalies and threats targeting sensitive data]
    O --&gt; P[Data Leakage/Loss Prevention]
    P --&gt; P1["Microsoft Defender for Storage"]
    J --&gt; Q(DP-3)
    Q --&gt; R[Encrypt sensitive data in transit]
    R --&gt; S[Data in Transit Encryption]
    S --&gt; S1["Azure Storage Account Configuration"]
    S1 --&gt; S2["Enforce minimum TLS version"]
    J --&gt; T(DP-4)
    T --&gt; U[Enable data at rest encryption by default]
    U --&gt; V[Data at Rest Encryption Using Platform Keys]
    V --&gt; WW["Azure Storage Account Configuration"]    
    J --&gt; W(DP-5)
    W --&gt; X[Use customer-managed key option in data at rest encryption when required]
    X --&gt; Y[Data at Rest Encryption Using CMK]
    Y --&gt; WW["Azure Storage Account Configuration"]    
    J --&gt; Z(DP-6)
    Z --&gt; AA[Use a secure key management process]
    AA --&gt; AB[Key Management in Azure Key Vault]
    AB --&gt; AC["DEPRECATED"]
</code></pre>
<pre class="mermaid"><code>graph LR  
    AC[Identity Management] --&gt;AD(IM-1)
    AD --&gt; AE[Use centralized identity and authentication system]
    AE --&gt; AE1["Microsoft Entra ID"]
    AE --&gt; AF[Microsoft Entra ID Authentication Required for Data Plane Access]
    AF --&gt; AF1["Azure Storage Account Configuration"]
    AF1 --&gt; AF2["Disable Allow Shared Key authorization"]
    AD --&gt; AG[Local Authentication Methods for Data Plane Access]
    AG --&gt; AG1["Azure Storage Account Configuration"]
    AG1 --&gt; AG2["Don't use SFTP if you don't need it"]
    AC --&gt; AH(IM-3)
    AH --&gt; AI[Manage application identities securely and automatically]
    AI --&gt; AJ[Managed Identities]
    AI --&gt; AK[Service Principals]
    AK --&gt; AK1["Rotate or regenerate service principal credentials"]
    AC --&gt; AL(IM-7)
    AL --&gt; AM[Restrict resource access based on conditions]
    AM --&gt; AN[Microsoft Entra Conditional Access for Data Plane]
    AC --&gt; AO(IM-8)
    AO --&gt; AP[Restrict the exposure of credential and secrets]    
    AP --&gt; AQ[Service Credential and Secrets Support Integration and Storage in Azure Key Vault]    
    AQ --&gt; AK1
    click AK1 "https://github.com/Azure-Samples/KeyVault-Rotation-StorageAccountKey-PowerShell" "Open this in a new tab" _blank
</code></pre>
<p></p><pre class="mermaid"><code>graph LR
AR[Logging and threat detection] --&gt;AS(LT-1)
    AS --&gt; AT[Enable threat detection capabilities]
    AT --&gt; AU[Microsoft Defender for Service / Product Offering]
    AU --&gt; AU1["Microsoft Defender for Storage"]
    AR --&gt; AV(LT-4)
    AV --&gt; AW[Enable network logging for security investigation]
    AW --&gt; AX[Azure Resource Logs]
    AX --&gt; AX1["Azure Monitor"]
    AX --&gt; AX2["Azure Activity Log"]
    click AU1 "https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-introduction" "Open this in a new tab" _blank
</code></pre>
<pre class="mermaid"><code>graph LR
    AY[Network Security] --&gt;AZ(NS-2)
    AZ --&gt; BA[Secure cloud services with network controls]
    BA --&gt; BB["Azure Storage Account Configuration"]
    BB --&gt; BB1[Disable Public Network Access]
    BB --&gt; BB2[Allow trusted Microsoft services to access the storage account]
    BA --&gt; BC[Azure Private Link]
    BC --&gt; BC1["Azure Private Endpoint"]
    BA --&gt; BD[Azure Network]
    BD --&gt; BD1["Azure Service Endpoint"]
    BA --&gt; BE["Network Security Perimeter"]
</code></pre><p></p>
<pre class="mermaid"><code>graph LR
    BD[Privileged Access] --&gt;BE(PA-7)
    BE --&gt; BF["Follow just enough administration(least privilege) principle"]
    BF --&gt; BG[Azure RBAC for Data Plane]
    BG --&gt; BG1["Azure RBAC"]
    BG1 --&gt; BG2["Azure RBAC Roles"]
    BD --&gt; BH(PA-8)
    BH --&gt; BI[Choose approval process for third-party support]
    BI --&gt; BJ[Customer Lockbox]
click BG2 "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/storage" "Open this in a new tab" _blank
</code></pre>
<h3 id="example-of-mixed-strategies-for-data-protection-in-azure-storage-accounts"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#example-of-mixed-strategies-for-data-protection-in-azure-storage-accounts">Example of mixed strategies for data protection in Azure storage accounts</a></h3>
<p>The following example illustrates how to implement mixed strategies for data protection in Azure storage accounts:</p>
<h3 id="conclusion"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#conclusion">Conclusion</a></h3>
<p>In conclusion, data threat modeling is an important process for identifying and addressing security vulnerabilities in Azure storage accounts. By identifying assets, threats, risks, and developing mitigation strategies, organizations can protect their data from security threats and ensure the security and integrity of their data assets. By following best practices and implementing security measures, organizations can prevent and detect data threats in Azure storage accounts and protect their data from security threats.</p>
<h3 id="references"><a class="toclink" href="16/data-threat-modeling-in-azure-storage-accounts/#references">References</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-overview">Azure Storage Account Documentation</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/service-guides/storage-accounts/security">Azure security baseline for Storage</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/service-guides/storage-accounts/security">Well Architected Framework - Storage Accounts and security</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/defender-for-storage/overview">Microsoft Defender for Storage</a></li>
<li><a href="https://center-for-threat-informed-defense.github.io/mappings-explorer/external/azure/">Azure MAPPINGS</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-15 00:00:00+00:00">June 15, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/azure-services/">Azure Services</a></li>
<li class="md-meta__item">
            
              3 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="tagging-best-practices-in-azure"><a class="toclink" href="15/tagging-best-practices-in-azure/">Tagging best practices in Azure</a></h2>
<p>In this post, I will show you some best practices for tagging resources in Azure.</p>
<h3 id="what-are-tags"><a class="toclink" href="15/tagging-best-practices-in-azure/#what-are-tags">What are tags?</a></h3>
<p>Tags are key-value pairs that you can assign to your Azure resources to organize and manage them more effectively. Tags allow you to categorize resources in different ways, such as by environment, owner, or cost center, and to apply policies and automation based on these categories.</p>
<p>If you don't know anything about tags, you can read the <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/tag-resources">official documentation</a> to learn more about them.</p>
<h3 id="why-use-tags"><a class="toclink" href="15/tagging-best-practices-in-azure/#why-use-tags">Why use tags?</a></h3>
<p>There are several reasons to use tags:</p>
<ul>
<li>
<p><strong>Organization</strong>: Tags allow you to organize your resources in a way that makes sense for your organization. You can use tags to group resources by environment, project, or department, making it easier to manage and monitor them.</p>
</li>
<li>
<p><strong>Cost management</strong>: Tags allow you to track and manage costs more effectively. You can use tags to identify resources that are part of a specific project or department, and to allocate costs accordingly.</p>
</li>
<li>
<p><strong>Automation</strong>: Tags allow you to automate tasks based on resource categories. You can use tags to apply policies, trigger alerts, or enforce naming conventions, making it easier to manage your resources at scale.</p>
</li>
</ul>
<h3 id="best-practices-for-tagging-resources-in-azure"><a class="toclink" href="15/tagging-best-practices-in-azure/#best-practices-for-tagging-resources-in-azure">Best practices for tagging resources in Azure</a></h3>
<p>Here are some best practices for tagging resources in Azure:</p>
<ul>
<li>
<p><strong>Use consistent naming conventions</strong>: Define a set of standard tags that you will use across all your resources. This will make it easier to search for and manage resources, and to apply policies and automation consistently.</p>
</li>
<li>
<p><strong>Apply tags at resource creation</strong>: Apply tags to resources when you create them, rather than adding them later. This will ensure that all resources are tagged correctly from the start, and will help you avoid missing or incorrect tags.</p>
</li>
<li>
<p><strong>Use tags to track costs</strong>: Use tags to track costs by project, department, or environment. This will help you allocate costs more effectively, and will make it easier to identify resources that are not being used or are costing more than expected.</p>
</li>
<li>
<p><strong>Define tags by hierarchy</strong>: Define tags in a hierarchy that makes sense for your organization, from more general at level subscription to more specific at resource group level. </p>
</li>
<li>
<p><strong>Use inherited tags</strong>: Use inherited tags to apply tags to resources automatically based on their parent resources. This will help you ensure that all resources are tagged consistently, and will reduce the risk of missing or incorrect tags. Exist Azure Policy to enforce inherited tags for example, you can check all in   <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/tag-policies#policy-definitions">Assign policy definitions for tag compliance</a></p>
</li>
<li>
<p><strong>Don't use tags for policy filtering</strong>: If you use Azure Policy, it's highly recommended not to use tag filtering in your policy rules when the policy relates to security setting, when you use tags to filter, resources without tag appear Compliance. Azure Policy exemptions or Azure Policy exclusions are recommended.</p>
</li>
<li>
<p><strong>Don't use tags for replace naming convention gaps</strong>: Tags are not a replacement for naming conventions. Use tags to categorize resources, and use naming conventions to identify resources uniquely.</p>
</li>
<li>
<p><strong>Use tags for automation</strong>: Use tags to trigger automation tasks, such as scaling, backup, or monitoring. You can use tags to define policies that enforce specific actions based on resource categories.</p>
</li>
<li>
<p><strong>Don't go crazy adding tags</strong>: Don't add too many tags to your resources. Keep it simple and use tags that are meaningful and useful. Too many tags can make it difficult to manage. You can begin with a small set of tags and expand as needed, for example: <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-tagging#minimum-suggested-tags">Minimum Suggested Tags</a></p>
</li>
<li>
<p><strong>Not all Azure services support tags</strong>: Keep in mind that not all Azure services support tags. You can check in the <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/tag-support">Tag support for Azure resources</a> to see which services support tags.</p>
</li>
</ul>
<h3 id="conclusion"><a class="toclink" href="15/tagging-best-practices-in-azure/#conclusion">Conclusion</a></h3>
<p>By using tags, you can organize and manage your resources more effectively, track and manage costs more efficiently, and automate tasks based on resource categories. I hope this post has given you a good introduction to tagging best practices in Azure and how you can use tags to optimize your cloud environment.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-13 00:00:00+00:00">June 13, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/azure-services/">Azure Services</a>, 
              <a class="md-meta__link" href="../../category/security/">Security</a></li>
<li class="md-meta__item">
            
              2 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="restrict-managed-disks-from-being-imported-or-exported"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/">Restrict managed disks from being imported or exported</a></h2>
<p>In this post, I will show you how to restrict managed disks from being imported or exported in Azure.</p>
<h3 id="what-are-managed-disks"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#what-are-managed-disks">What are managed disks?</a></h3>
<p>Azure Managed Disks are block-level storage volumes that are managed by Azure and used with Azure Virtual Machines. Managed Disks are designed for high availability and durability, and they provide a simple and scalable way to manage your storage.</p>
<p>If you don't know anything about Azue Managed Disks, grab a cup of coffee( it will take you a while), you can read the <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/managed-disks-overview">official documentation</a> to learn more about them.</p>
<h3 id="why-restrict-managed-disks-from-being-imported-or-exported"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#why-restrict-managed-disks-from-being-imported-or-exported">Why restrict managed disks from being imported or exported?</a></h3>
<p>There are several reasons to restrict managed disks from being imported or exported:</p>
<ul>
<li><strong>Security</strong>: By restricting managed disks from being imported or exported, you can reduce the risk of unauthorized access to your data.</li>
<li><strong>Compliance</strong>: By restricting managed disks from being imported or exported, you can help ensure that your organization complies with data protection regulations.</li>
</ul>
<h3 id="how-to-restrict-managed-disks-from-being-imported-or-exported"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#how-to-restrict-managed-disks-from-being-imported-or-exported">How to restrict managed disks from being imported or exported</a></h3>
<h4 id="at-deployment-time"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#at-deployment-time">At deployment time</a></h4>
<p>An example with azcli:</p>
<h5 id="create-a-managed-disk-with-public-network-access-disabled"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#create-a-managed-disk-with-public-network-access-disabled">Create a managed disk with public network access disabled</a></h5>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>## Create a managed disk with public network access disabled
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>az disk create --resource-group myResourceGroup --name myDisk --size-gb 128 --location eastus --sku Standard_LRS --no-wait --public-network-access disabled 
</span></code></pre></div>
<h5 id="create-a-managed-disk-with-public-network-access-disabled-and-private-endpoint-enabled"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#create-a-managed-disk-with-public-network-access-disabled-and-private-endpoint-enabled">Create a managed disk with public network access disabled and private endpoint enabled</a></h5>
<p>Follow <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/linux/disks-export-import-private-links-cli#log-in-into-your-subscription-and-set-your-variables">Azure CLI - Restrict import/export access for managed disks with Private Links</a></p>
<h4 id="at-scale"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#at-scale">At Scale</a></h4>
<p>If you want to restrict managed disks from being imported or exported, you can use Azure Policy to enforce this restriction. Azure Policy is a service in Azure that you can use to create, assign, and manage policies that enforce rules and effects over your resources. By using Azure Policy, you can ensure that your resources comply with your organization's standards and service-level agreements.</p>
<p>To restrict managed disks from being imported or exported using Azure Policy, you can use or create a policy definition that specifies the conditions under which managed disks can be imported or exported. You can then assign this policy definition to a scope, such as a management group, subscription, or resource group, to enforce the restriction across your resources.</p>
<p>In this case we have a Built-in policy definition that restricts managed disks from being imported or exported <a href="https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F582bd7a6-a5f6-4dc6-b9dc-9cb81fe0d4c5">Configure disk access resources with private endpoints</a></p>
<h3 id="conclusion"><a class="toclink" href="13/restrict-managed-disks-from-being-imported-or-exported/#conclusion">Conclusion</a></h3>
<p>In this post, I showed you how to restrict managed disks from being imported or exported in Azure. By restricting managed disks from being imported or exported, you can reduce the risk of unauthorized access to your data and help ensure that your organization complies with data protection regulations. </p>
<p>Curiosly, restrict managed disks from being imported or exported, it's not a compliance check in the Microsoft cloud security benchmark but it's a good practice to follow.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-12 00:00:00+00:00">June 12, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/microsoft-entra-id/">Microsoft Entra ID</a></li>
<li class="md-meta__item">
            
              8 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="microsoft-entra-id-privileged-identity-management"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/">Microsoft Entra ID Privileged Identity Management</a></h2>
<p>In this post, I will show you how to use Microsoft Entra ID Privileged Identity Management (PIM) to manage and monitor access to privileged roles in your organization.</p>
<h3 id="what-is-microsoft-entra-id-privileged-identity-management"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#what-is-microsoft-entra-id-privileged-identity-management">What is Microsoft Entra ID Privileged Identity Management?</a></h3>
<p>Microsoft Entra ID Privileged Identity Management (PIM) is a service that helps you manage, control, and monitor access within your organization. It provides just-in-time privileged access to Azure AD and Azure resources, along with access reviews and monitoring capabilities.</p>
<h3 id="reasons-to-use-microsoft-entra-id-pim"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#reasons-to-use-microsoft-entra-id-pim">Reasons to Use Microsoft Entra ID PIM</a></h3>
<p>There are several reasons to use Microsoft Entra ID PIM:</p>
<ul>
<li><strong>Security</strong>: Microsoft Entra ID PIM helps you reduce the risk of unauthorized access to privileged roles.</li>
<li><strong>Compliance</strong>: Microsoft Entra ID PIM helps you meet compliance requirements by providing access reviews and monitoring capabilities.</li>
<li><strong>Efficiency</strong>: Microsoft Entra ID PIM provides just-in-time access to privileged roles, reducing the risk of unauthorized access.</li>
<li><strong>Monitoring</strong>: Microsoft Entra ID PIM provides monitoring and alerts that help you detect and respond to suspicious activities.</li>
<li><strong>Traceability</strong>: Microsoft Entra ID PIM provides an audit trail of all access requests and approvals, helping you track who has access to privileged roles.</li>
</ul>
<p>Maybe you can't use Microsoft Entra ID PIM to log all changess that the users do in the system, but you can use <a href="https://techcommunity.microsoft.com/t5/azure-governance-and-management/announcing-the-general-availability-of-change-actor/ba-p/4171801">Actor Change</a> for that.</p>
<h3 id="key-features-of-microsoft-entra-id-pim"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#key-features-of-microsoft-entra-id-pim">Key Features of Microsoft Entra ID PIM</a></h3>
<p>Microsoft Entra ID PIM offers several key features that help you manage and monitor access to privileged roles:</p>
<ul>
<li>Provide just-in-time privileged access to Microsoft Entra ID and Azure resources.</li>
<li>Assign time-bound access to resources using start and end dates.</li>
<li>Require approval to activate privileged roles.</li>
<li>Enforce multifactor authentication to activate any role.</li>
<li>Use justification to understand why users activate.</li>
<li>Get notifications when users activate privileged roles.</li>
<li>Conduct access reviews to ensure users still need roles.</li>
<li>Download audit history for internal or external audit.</li>
<li>Prevent removal of the last active Global Administrator and Privileged Role Administrator role assignments.</li>
</ul>
<h3 id="how-to-use-microsoft-entra-id-pim"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#how-to-use-microsoft-entra-id-pim">How to Use Microsoft Entra ID PIM</a></h3>
<p>We can manage three types of "things" in Microsoft Entra ID PIM:</p>
<ul>
<li><strong>Microsoft Entra roles.</strong> Microsoft Entra roles are also referred to as directory roles. They include built-in and custom roles to manage Microsoft Entra ID and other Microsoft 365 online services.</li>
<li><strong>PIM for Groups.</strong> To set up just-in-time access to the member and owner role of a Microsoft Entra security group. PIM for Groups provides an alternative way to set up PIM for Microsoft Entra roles and Azure roles. It also allows you to set up PIM for other permissions across Microsoft online services like Intune, Azure Key Vaults, and Microsoft Entra ID Protection.</li>
<li><strong>Azure roles.</strong> Azure's role-based access control roles that grant access to management groups, subscriptions, resource groups, and resources.</li>
</ul>
<h4 id="microsoft-entra-id-roles"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#microsoft-entra-id-roles">Microsoft Entra ID roles</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use groups, you need create eligible groups, for now the maximum number of eligible groups is 500.</p>
</div>
<p>In the Microsoft Entra ID portal, you can manage Microsoft Entra ID roles by selecting the "Roles" tab. Here you can see all the roles that are available to you, as well as the roles that you have activated.</p>
<p>You can made the following actions:</p>
<ul>
<li><strong>Assign</strong>: Create assignments for Microsoft Entra ID roles, update existing assignments to ensure that users have just-in-time access to privileged roles.</li>
<li><strong>Activate</strong>: Activate your eligible assignments to get just-in-time access to privileged roles. </li>
<li><strong>Approve</strong>: List, approve, or deny activation requests for Microsoft Entra ID roles.</li>
<li><strong>Audit</strong>: View and export a history of all assignments and activations done in PIM so you can identify attacks and stay compliant.</li>
</ul>
<p>Ok, let's see how to assign a role to a group.</p>
<p>In the "Roles" tab, click on the role that you want to assign. </p>
<p>In Role settings, edit the settings for the role, modify Activation, Assignment, and Notification settings and then click "Update. These are the default settings:</p>
<p><strong>Activation</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Activation maximum duration (hours)</th>
<th>8 hour(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>On activation, require</td>
<td>None</td>
</tr>
<tr>
<td>Require justification on activation</td>
<td>Yes</td>
</tr>
<tr>
<td>Require ticket information on activation</td>
<td>No</td>
</tr>
<tr>
<td>Require approval to activate</td>
<td>No</td>
</tr>
<tr>
<td>Approvers</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Assignment</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Allow permanent eligible assignment</th>
<th>Yes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Expire eligible assignments after</td>
<td>-</td>
</tr>
<tr>
<td>Allow permanent active assignment</td>
<td>Yes</td>
</tr>
<tr>
<td>Expire active assignments after</td>
<td>-</td>
</tr>
<tr>
<td>Require Azure Multi-Factor Authentication on active assignment</td>
<td>No</td>
</tr>
<tr>
<td>Require justification on active assignment</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p><strong>Send notifications when members are assigned as eligible to this role:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Default recipients</th>
<th>Additional recipients</th>
<th>Critical emails only</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Role assignment alert</th>
<th>Admin</th>
<th>None</th>
<th>False</th>
</tr>
</thead>
<tbody>
<tr>
<td>Notification to the assigned user (assignee)</td>
<td>Assignee</td>
<td>None</td>
<td>False</td>
</tr>
<tr>
<td>Request to approve a role assignment renewal/extension</td>
<td>Approver</td>
<td>None</td>
<td>False</td>
</tr>
</tbody>
</table>
<p><strong>Send notifications when members are assigned as active to this role:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Default recipients</th>
<th>Additional recipients</th>
<th>Critical emails only</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Role assignment alert</th>
<th>Admin</th>
<th>None</th>
<th>False</th>
</tr>
</thead>
<tbody>
<tr>
<td>Notification to the assigned user (assignee)</td>
<td>Assignee</td>
<td>None</td>
<td>False</td>
</tr>
<tr>
<td>Request to approve a role assignment renewal/extension</td>
<td>Approver</td>
<td>None</td>
<td>False</td>
</tr>
</tbody>
</table>
<p><strong>Send notifications when eligible members activate this role:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Default recipients</th>
<th>Additional recipients</th>
<th>Critical emails only</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Role activation alert</th>
<th>Admin</th>
<th>None</th>
<th>False</th>
</tr>
</thead>
<tbody>
<tr>
<td>Notification to activated user (requestor)</td>
<td>Requestor</td>
<td>None</td>
<td>False</td>
</tr>
<tr>
<td>Request to approve an activation</td>
<td>Approver</td>
<td>None</td>
<td>False</td>
</tr>
</tbody>
</table>
<p>In the "Assignments" tab, click on "Add assignments". In Membership, select the scope type: Application, Device, Directory, Group, Service Principal or User (It's dependes of each role)  and select the identity related that you want to assign the role to. We are going to select Directory and a eligible group,  and then click "Next". </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>App registrations are supported in PIM for Microsoft Entra ID roles but only in active assignments. </p>
</div>
<p>In the "Settings" tab, you can set the Assigment type: Eligible or I need to do something to activate and Active or I don't need to do nothing to activate my role. You can configure too if you want that the duration of the assignment is permanent or if you want to expire the assignment after a certain period of time. Once you're done, click "Assign".</p>
<p>You can set the activation settings, assignment settings, and notification settings for the assignment. Once you're done, click "Assign".</p>
<h4 id="pim-for-groups"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#pim-for-groups">PIM for Groups</a></h4>
<p>In the Microsoft Entra ID portal, you can manage PIM for Groups by selecting the "Groups" tab. </p>
<p>First you need to discover the groups that you want to manage. In the "Groups" tab, click on "Discover groups". In the "Discover groups" pane, you can search for groups by name. Once you've found the group you want to manage, click on "Add to PIM".</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You must be an owner of the group or have Microsoft Entra role that allows to discover and manage group in PIM.</p>
</div>
<p>Now, in the "Groups" tab, you can see all the groups that you have discovered.</p>
<p>In the "Groups" tab, click on the group that you want to manage. You can made the following actions under manage:</p>
<ul>
<li><strong>Assign</strong>: Create assignments for the member and owner role of the group, update existing assignments to ensure that users have just-in-time access to privileged roles.</li>
<li><strong>Activate</strong>: Activate your eligible assignments to get just-in-time access to privileged roles.</li>
<li><strong>Approve</strong>: List, approve, or deny activation requests for the member and owner role of the group.</li>
<li><strong>Audit</strong>: View and export a history of all assignments and activations done in PIM so you can identify attacks and stay compliant.</li>
</ul>
<p>Ok, let's see how to assign a role to a group.</p>
<p>In the "Groups" tab, click on the group that you want to assign a role to. </p>
<p>In Role settings, edit the settings for the role, modify Activation, Assignment, and Notification settings for members or users, these settings are the same that we saw in the Microsoft Entra ID roles section.</p>
<p>In the "Assignments" tab, click on "Add assignments". In Select role, select the scope type: Member or Owner and in Select members select the identity related that you want to assign the role to or groupm, if you select a group, you doesn't need a eligible group,  and then click "Next".</p>
<p>In the "Settings" tab, you can set the Assigment type: Eligible or I need to do something to activate and Active or I don't need to do nothing to activate my role. You can configure too if you want that the duration of the assignment is permanent or if you want to expire the assignment after a certain period of time. Once you're done, click "Assign".</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>App registrations are supported in PIM for Groups but only in active assignments. I think that this is very useful for IaC for example because you can assign a role to a service principal and you can activate the role when you need it.</p>
</div>
<p>Example of a sequence diagram of the activation process for a group:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant PIM
    participant Approver
    participant MFA
    participant Group

    User-&gt;&gt;PIM: Logs in
    User-&gt;&gt;PIM: Navigates to PIM and selects "My roles"
    User-&gt;&gt;PIM: Selects eligible group
    User-&gt;&gt;PIM: Requests activation
    PIM-&gt;&gt;MFA: Requests multi-factor authentication
    MFA--&gt;&gt;User: MFA request
    User-&gt;&gt;MFA: Provides MFA credentials
    MFA--&gt;&gt;PIM: MFA confirmation
    PIM-&gt;&gt;User: Requests justification
    User-&gt;&gt;PIM: Provides justification
    PIM-&gt;&gt;Approver: Sends approval request
    Approver--&gt;&gt;PIM: Approval
    PIM--&gt;&gt;User: Activation confirmation
    PIM-&gt;&gt;Group: Activates temporary membership
    Group--&gt;&gt;PIM: Activation confirmation
    PIM--&gt;&gt;User: Access granted
</code></pre>
<h4 id="azure-roles"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#azure-roles">Azure roles</a></h4>
<p>In the Microsoft Entra ID portal, you can manage Azure roles by selecting the "Azure resources" tab. Here you can see all the Azure roles that are available to you by scope, as well as the roles that you have activated.</p>
<p>First you need to select the Azure resource that you want to manage: Management groups, Subscriptions, Resource groups or Resources and follow Manage Resource.</p>
<p>Once here, same as the other sections, you can made the following actions for this scope:</p>
<ul>
<li><strong>Assign</strong>: Create assignments for the member and owner role of the group, update existing assignments to ensure that users have just-in-time access to privileged roles.</li>
<li><strong>Activate</strong>: Activate your eligible assignments to get just-in-time access to privileged roles.</li>
<li><strong>Approve</strong>: List, approve, or deny activation requests for the member and owner role of the group.</li>
<li><strong>Audit</strong>: View and export a history of all assignments and activations done in PIM so you can identify attacks and stay compliant.</li>
</ul>
<p>Ok, let's see how to assign a role to a identity in a scope.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>We already have a scope selected</p>
</div>
<p>In the "Assignments" tab, click on "Add assignments". In Select role, select the role that you want to assign and in Select members select the identity related that you want to assign the role to or group, if you select a group, you doesn't need a eligible group,  and then click "Next".</p>
<p>In the "Settings" tab, you can set the Assigment type: Eligible or I need to do something to activate and Active or I don't need to do nothing to activate my role. You can configure too if you want that the duration of the assignment is permanent or if you want to expire the assignment after a certain period of time. Once you're done, click "Assign".</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>App registrations are supported in PIM for Azure roles but only in active assignments. I think that this is very useful for IaC for example because you can assign a role to a service principal and you can activate the role when you need it.</p>
</div>
<p>Don't forget review settings for the role, modify Activation, Assignment, and Notification settings for members or users, these settings are the same that we saw in the Microsoft Entra ID roles section.</p>
<h3 id="conclusion"><a class="toclink" href="12/microsoft-entra-id-privileged-identity-management/#conclusion">Conclusion</a></h3>
<p>Microsoft Entra ID Privileged Identity Management (PIM) is a powerful service that helps you manage and monitor access to privileged roles in your organization. By using Microsoft Entra ID PIM, you can reduce the risk of unauthorized access, meet compliance requirements, and improve the efficiency of your organization. I hope this post has helped you understand how to use Microsoft Entra ID PIM and how it can benefit your organization.</p>
<p>If you want to play with Microsoft Enter ID PIM, you can use a test on a new tenant or the current one if you haven't used it before.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-11 00:00:00+00:00">June 11, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/azure-services/">Azure Services</a>, 
              <a class="md-meta__link" href="../../category/power-bi/">Power BI</a></li>
<li class="md-meta__item">
            
              4 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/">Securely connect Power BI to data sources with a VNet data gateway</a></h2>
<p>In this post, I will show you how to securely connect Power BI to your Azure data services using a Virtual Network (VNet) data gateway.</p>
<h3 id="what-is-a-virtual-network-vnet-data-gateway"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#what-is-a-virtual-network-vnet-data-gateway">What is a Virtual Network (VNet) data gateway?</a></h3>
<p>The virtual network (VNet) data gateway helps you to connect from Microsoft Cloud services to your Azure data services within a VNet without the need of an on-premises data gateway. The VNet data gateway securely communicates with the data source, executes queries, and transmits results back to the service.</p>
<h3 id="the-role-of-a-vnet-data-gateway"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#the-role-of-a-vnet-data-gateway">The Role of a VNet Data Gateway</a></h3>
<p>A VNet data gateway acts as a bridge that allows for the secure flow of data between the Power Platform and external data sources that reside within a virtual network. This includes services such as SQL databases, file storage solutions, and other cloud-based resources. The gateway ensures that data can be transferred securely and reliably, without exposing the network to potential threats or breaches.</p>
<h3 id="how-it-works"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#how-it-works">How It Works</a></h3>
<pre class="mermaid"><code>graph LR
    User([User]) --&gt;|Semantic Models| SM[Semantic Models]
    User --&gt;|"Dataflows (Gen2)"| DF["Dataflows (Gen2)"]
    User --&gt;|Paginated Reports| PR[Paginated Reports]
    SM --&gt; PPVS[Power Platform VNET Service]
    DF --&gt; PPVS
    PR --&gt; PPVS
    PPVS --&gt; MCVG[Managed Container<br>for VNet Gateway]
    MCVG --&gt;|Interfaces with| SQLDB[(SQL Databases)]
    MCVG --&gt;|Interfaces with| FS[(File Storage)]
    MCVG --&gt;|Interfaces with| CS[(Cloud Services)]
    MCVG -.-&gt;|Secured by| SEC{{Security Features}}

    subgraph VNET_123
    SQLDB
    FS
    CS
    SEC
    end

    classDef filled fill:#f96,stroke:#333,stroke-width:2px;
    classDef user fill:#bbf,stroke:#f66,stroke-width:2px,stroke-dasharray: 5, 5;
    class User user
    class SM,DF,PR,PPVS,MCVG,SQLDB,FS,CS,SEC filled
</code></pre>
<p>The process begins with a user leveraging Power Platform services like Semantic Models, Dataflows (Gen2), and Paginated Reports. These services are designed to handle various data-related tasks, from analysis to visualization. They connect to the Power Platform VNET Service, which is the heart of the operation, orchestrating the flow of data through the managed container for the VNet gateway.</p>
<p>This managed container is a secure environment specifically designed for the VNet gateway’s operations. It’s isolated from the public internet, ensuring that the data remains protected within the confines of the virtual network. Within this secure environment, the VNet gateway interfaces with the necessary external resources, such as SQL databases and cloud storage, all while maintaining strict security protocols symbolized by the padlock icon in our diagram.</p>
<p>If you need to connect to services on others VNets, you can use <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview">VNet peering</a> to connect the VNets, and maybe access to on-premises resources using <a href="https://docs.microsoft.com/en-us/azure/expressroute/expressroute-introduction">ExpressRoute</a> or other VPN solutions.</p>
<h3 id="the-benefits"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#the-benefits">The Benefits</a></h3>
<p>By utilizing a VNet data gateway, organizations can enjoy several benefits:</p>
<ul>
<li>Enhanced Security: The gateway provides a secure path for data, safeguarding sensitive information and complying with organizational security policies.</li>
<li>Network Isolation: The managed container and the virtual network setup ensure that the data does not traverse public internet spaces, reducing exposure to vulnerabilities.</li>
<li>Seamless Integration: The gateway facilitates smooth integration between Power Platform services and external data sources, enabling efficient data processing and analysis.</li>
</ul>
<h3 id="getting-started"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#getting-started">Getting Started</a></h3>
<p>To set up a VNet data gateway, follow these steps:</p>
<h4 id="register-microsoftpowerplatform-as-a-resource-provider"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#register-microsoftpowerplatform-as-a-resource-provider">Register Microsoft.PowerPlatform as a resource provider</a></h4>
<p>Before you can create a VNet data gateway, you need to register the Microsoft.PowerPlatform resource provider. This can be done using the Azure portal or the Azure CLI.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>az provider register --namespace Microsoft.PowerPlatform
</span></code></pre></div>
<h4 id="associate-the-subnet-to-microsoft-power-platform"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#associate-the-subnet-to-microsoft-power-platform">Associate the subnet to Microsoft Power Platform</a></h4>
<p>Create a VNet in your Azure subscription and a subnet where the VNet data gateway will be deployed. Next, you need to delegate subnet to service <strong>Microsoft.PowerPlatform/vnetaccesslinks</strong>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This subnet can't be shared with other services.</li>
<li>Five IP addresses are reserved in the subnet for basic functionality. You need to reserve additional IP addresses for the VNet data gateway, add more IPs for future gateways.</li>
<li>You need a role with the Microsoft.Network/virtualNetworks/subnets/join/action permission</li>
</ul>
</div>
<p>This can be done using the Azure portal or the Azure CLI.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a># Create a VNet and address prefix 10.0.0.0/24
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>az network vnet create --name MyVNet --resource-group MyResourceGroup --location eastus --address-prefixes 10.0.0.0/24
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a># Create a Netwrok Security Group
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>az network nsg create --name MyNsg --resource-group MyResourceGroup --location eastus
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a># Create a subnet with delegation to Microsoft.PowerPlatform/vnetaccesslinks and associate the NSG
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>az network vnet subnet create --name MySubnet --vnet-name MyVNet --resource-group MyResourceGroup --address-prefixes 10.0.0.1/27 --network-security-group MyNsg --delegations Microsoft.PowerPlatform/vnetaccesslinks
</span></code></pre></div>
<h4 id="create-a-vnet-data-gateway"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#create-a-vnet-data-gateway">Create a VNet data gateway</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Microsoft Power Platform User with with Microsoft.Network/virtualNetworks/subnets/join/action permission on the VNet is required. Network Contributor role is not necessary.</p>
</div>
<ol>
<li>Sign in to the <a href="https://app.powerbi.com/">Power BI homepage</a>.</li>
<li>In the top navigation bar, select the settings gear icon on the right.</li>
<li>From the drop down, select the Manage connections and gateways page, in Resources and extensions.</li>
<li>Select <strong>Create a virtual network data gateway.</strong>.</li>
<li>Select the license capacity, subscription, resource group, VNet and the Subnet. Only subnets that are delegated to Microsoft Power Platform are displayed in the drop-down list. VNET data gateways require a <a href="https://learn.microsoft.com/en-us/power-bi/enterprise/service-premium-what-is">Power BI Premium capacity</a> license (A4 SKU or higher or any P SKU) or <a href="https://learn.microsoft.com/en-us/fabric/enterprise/buy-subscription">Fabric license</a> to be used (any SKU).</li>
<li>By default, we provide a unique name for this data gateway, but you could optionally update it.</li>
<li>Select <strong>Save</strong>. This VNet data gateway is now displayed in your <strong>Virtual network data gateways</strong> tab. A VNet data gateway is a managed gateway that could be used for controlling access to this resource for Power platform users.</li>
</ol>
<h3 id="conclusion"><a class="toclink" href="11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#conclusion">Conclusion</a></h3>
<p>The VNet data gateway is a powerful tool that enables secure data transfer between the Power Platform and external data sources residing within a virtual network. By leveraging this gateway, organizations can ensure that their data remains protected and compliant with security standards, all while facilitating seamless integration and analysis of data. If you are looking to enhance the security and reliability of your data connections, consider implementing a VNet data gateway in your environment.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-10 00:00:00+00:00">June 10, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/devops/">DevOps</a></li>
<li class="md-meta__item">
            
              2 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="implementing-policy-as-code-with-open-policy-agent"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/">Implementing policy as code with Open Policy Agent</a></h2>
<p>In this post, I will show you how to implement policy as code with Open Policy Agent (OPA) and Azure.</p>
<h3 id="what-is-open-policy-agent"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#what-is-open-policy-agent">What is Open Policy Agent?</a></h3>
<p>Open Policy Agent (OPA) is an open-source, general-purpose policy engine that enables you to define and enforce policies across your cloud-native stack. OPA provides a high-level declarative language called Rego that you can use to write policies that are easy to understand and maintain.</p>
<h3 id="why-use-open-policy-agent"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#why-use-open-policy-agent">Why use Open Policy Agent?</a></h3>
<p>There are several reasons to use OPA:</p>
<ul>
<li><strong>Consistency</strong>: OPA allows you to define policies in a single place and enforce them consistently across your cloud-native stack.</li>
<li><strong>Flexibility</strong>: OPA provides a flexible policy language that allows you to define policies that are tailored to your specific requirements.</li>
<li><strong>Auditability</strong>: OPA provides a transparent and auditable way to enforce policies, making it easy to understand why a policy decision was made.</li>
<li><strong>Integration</strong>: OPA integrates with a wide range of cloud-native tools and platforms, making it easy to enforce policies across your entire stack.</li>
</ul>
<h3 id="getting-started-with-open-policy-agent"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#getting-started-with-open-policy-agent">Getting started with Open Policy Agent</a></h3>
<p>To get started with OPA, you need to install the OPA CLI and write some policies in Rego.</p>
<p>You can install the OPA CLI by downloading the binary from the <a href="https://github.com/open-policy-agent/opa/releases">OPA GitHub releases page</a>, you can check the <a href="https://www.openpolicyagent.org/docs/latest/#running-opa">installation guide</a> for more details.</p>
<p>Once you have installed the OPA CLI, you can write policies in Rego. Rego is a high-level declarative language that allows you to define policies in a clear and concise way.</p>
<p>Here's a simple example of a policy that enforces a naming convention for Azure resources:</p>
<div class="language-rego highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">package</span><span class="w"> </span><span class="n">azure</span><span class="p">.</span><span class="n">resources</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">default</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">allow</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">resource</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Microsoft.Compute/virtualMachines"</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="nb">input</span><span class="p">.</span><span class="n">resource</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"my-vm"</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">}</span>
</span></code></pre></div>
<p>This policy allows resources of type <code>Microsoft.Compute/virtualMachines</code> with the name <code>my-vm</code>. You can write more complex policies that enforce a wide range of requirements, such as resource tagging, network security, and access control.</p>
<h3 id="integrating-open-policy-agent-with-azure"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#integrating-open-policy-agent-with-azure">Integrating Open Policy Agent with Azure</a></h3>
<p>To integrate OPA with Azure, you can use the Azure Policy service, which allows you to define and enforce policies across your Azure resources. You can use OPA to define custom policies that are not supported by Azure Policy out of the box, or to enforce policies across multiple cloud providers.</p>
<h3 id="conclusion"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#conclusion">Conclusion</a></h3>
<p>Open Policy Agent is a powerful tool that allows you to define and enforce policies across your cloud-native stack. By using OPA, you can ensure that your infrastructure is secure, compliant, and consistent, and that your policies are easy to understand and maintain. I hope this post has given you a good introduction to OPA and how you can use it to implement policy as code in your cloud-native environment.</p>
<h3 id="additional-resources"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#additional-resources">Additional resources</a></h3>
<p>I have created a <a href="https://github.com/rfernandezdo/rego-examples">GitHub repository</a> with some examples of policies written in Rego that you can use as a starting point for your own policies.</p>
<h3 id="references"><a class="toclink" href="10/implementing-policy-as-code-with-open-policy-agent/#references">References</a></h3>
<ul>
<li><a href="https://www.openpolicyagent.org/">Open Policy Agent</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/governance/policy/overview">Azure Policy</a></li>
<li><a href="https://www.openpolicyagent.org/docs/latest/policy-language/">Rego language</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael Fernández" src="https://avatars.githubusercontent.com/u/39990341">
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-09 00:00:00+00:00">June 9, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../category/azure-services/">Azure Services</a>, 
              <a class="md-meta__link" href="../../category/finops/">FinOps</a></li>
<li class="md-meta__item">
            
              4 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="finops-for-azure-optimizing-your-cloud-spend"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/">FinOps for Azure: Optimizing Your Cloud Spend</a></h2>
<p>In the cloud era, optimizing cloud spend has become a critical aspect of financial management. FinOps, a set of financial operations practices, empowers organizations to get the most out of their Azure investment. This blog post dives into the core principles of FinOps, explores the benefits it offers, and outlines practical strategies for implementing FinOps in your Azure environment.</p>
<h3 id="understanding-the-cloud-cost-challenge"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#understanding-the-cloud-cost-challenge">Understanding the Cloud Cost Challenge</a></h3>
<p>Traditional IT expenditure followed a capital expenditure (capex) model, where businesses purchased hardware and software upfront. Cloud computing introduces a paradigm shift with the operational expenditure (opex) model. Here, businesses pay for resources as they consume them, leading to variable and unpredictable costs.</p>
<p>FinOps tackles this challenge by providing a framework for managing cloud finances. It encompasses three key pillars:</p>
<ul>
<li><strong>People:</strong> Establish a FinOps team or designate individuals responsible for overseeing cloud costs. This team should possess a blend of cloud technical expertise, financial acumen, and business process knowledge.</li>
<li><strong>Process:</strong>  Define processes for budgeting, forecasting, and monitoring cloud expenses. This involves setting spending limits, creating chargeback models for different departments, and regularly reviewing cost reports.</li>
<li><strong>Tools:</strong> Leverage Azure Cost Management, a suite of tools that provides granular insights into your Azure spending. It enables cost allocation by resource, service, department, or any other relevant dimension.</li>
</ul>
<p>It's essential to adopt a FinOps mindset that encourages collaboration between finance, IT, and business teams to drive cost efficiency and value realization in the cloud.</p>
<p>It's important to note that FinOps is not just about cost-cutting; it's about optimizing cloud spending to align with business objectives and maximize ROI.</p>
<h3 id="azure-cost-management-optimizing-your-azure-spending"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#azure-cost-management-optimizing-your-azure-spending">Azure Cost Management: Optimizing Your Azure Spending</a></h3>
<p>Azure Cost Management empowers you to analyze your Azure spending patterns and identify cost-saving opportunities. Here's a glimpse into its key functionalities:</p>
<ul>
<li><strong>Cost Views:</strong> Generate comprehensive reports that categorize your Azure spending by various attributes like resource group, service, or department.</li>
<li><strong>Cost Alerts:</strong> Set up proactive alerts to notify you when your spending exceeds predefined thresholds.</li>
<li><strong>Reservations:</strong> Purchase reserved instances of frequently used Azure resources for significant upfront discounts.</li>
<li><strong>Recommendations:</strong> Azure Cost Management analyzes your usage patterns and recommends potential cost-saving measures, such as rightsizing resources or leveraging spot instances.</li>
</ul>
<h3 id="the-power-of-tags-and-azure-policy"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#the-power-of-tags-and-azure-policy">The Power of Tags and Azure Policy</a></h3>
<p>Tags are metadata labels that you can attach to your Azure resources to categorize and track them effectively. They play a pivotal role in FinOps by enabling you to:</p>
<ul>
<li>Associate costs with specific departments, projects, or applications.</li>
<li>Identify unused or underutilized resources for potential cost savings.</li>
<li>Simplify cost allocation and chargeback processes.</li>
</ul>
<p>Azure Policy helps enforce tagging standards and governance rules across your Azure environment. You can define policies that mandate specific tags for all resources, ensuring consistent cost allocation and data accuracy.</p>
<h3 id="benefits-of-implementing-finops"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#benefits-of-implementing-finops">Benefits of Implementing FinOps</a></h3>
<p>A well-defined FinOps strategy empowers you to:</p>
<ul>
<li><strong>Gain Visibility into Cloud Spending:</strong>  Obtain a clear picture of your Azure expenditures, enabling informed budgeting and cost control decisions.</li>
<li><strong>Optimize Cloud Costs:</strong> Identify and eliminate wasteful spending through cost-saving recommendations and proactive measures.</li>
<li><strong>Improve Cloud Governance:</strong>  Enforce tagging policies and spending limits to ensure responsible cloud resource utilization.</li>
<li><strong>Align Cloud Spending with Business Value:</strong>  Make data-driven decisions about cloud investments that support your business objectives.</li>
</ul>
<h3 id="getting-started-with-finops-in-azure"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#getting-started-with-finops-in-azure">Getting Started with FinOps in Azure</a></h3>
<p>Implementing FinOps doesn't necessitate a complex overhaul. Here's a recommended approach:</p>
<ol>
<li><strong>Establish a FinOps Team:</strong>  Assemble a cross-functional team comprising representatives from finance, IT, and business departments.</li>
<li><strong>Set Clear Goals and Objectives:</strong>  Define your FinOps goals, whether it's reducing costs by a specific percentage or improving budget forecasting accuracy.</li>
<li><strong>Leverage Azure Cost Management:</strong>  Start by exploring Azure Cost Management to understand your current spending patterns.</li>
<li><strong>Implement Basic Tagging Standards:</strong>  Enforce basic tagging policies to categorize your Azure resources for cost allocation purposes.</li>
<li><strong>Continuously Monitor and Refine:</strong>  Regularly review your cloud cost reports and identify areas for further optimization.</li>
</ol>
<p>By following these steps and embracing a FinOps culture, you can effectively manage your Azure expenses and derive maximum value from your cloud investment.</p>
<h3 id="toolchain-for-finops-in-azure"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#toolchain-for-finops-in-azure">Toolchain for FinOps in Azure</a></h3>
<p>To streamline your FinOps practices in Azure, consider leveraging the following tools:</p>
<pre class="mermaid"><code>graph LR
A[Financial Operations Practices] --&gt; B{Cloud Spend Optimization}
B --&gt; C{Cost Visibility}
B --&gt; D{Cost Optimization}
B --&gt; E{Governance}
C --&gt; F{Azure Cost Management}
D --&gt; G{Azure Advisor}
E --&gt; H{Azure Policy}
F --&gt; I{Cost Views}
F --&gt; J{Cost Alerts}
G --&gt; K{Cost Recommendations}
H --&gt; L{Tag Enforcement}
</code></pre>
<p>This toolchain combines Azure Cost Management, Azure Advisor, and Azure Policy to provide a comprehensive suite of capabilities for managing your Azure spending effectively.</p>
<p><strong>Highly recommended</strong>, you can check <a href="https://microsoft.github.io/finops-toolkit/">FinOps toolkit</a>, it's a set of tools and best practices to help you implement FinOps in your organization, it includes tools for cost allocation, budgeting, and forecasting, as well as best practices for FinOps implementation.</p>
<h3 id="conclusion"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#conclusion">Conclusion</a></h3>
<p>FinOps is an essential practice for organizations leveraging Azure. It empowers you to make informed decisions about your cloud finances, optimize spending, and achieve your business goals. As an Azure Solutions Architect, I recommend that you establish a FinOps practice within your organization to unlock the full potential of Azure and achieve financial efficiency in the cloud.</p>
<p>This blog post provides a foundational understanding of FinOps in Azure. </p>
<p>By embracing FinOps, you can transform your cloud cost management practices and drive business success in the cloud era.</p>
<h3 id="references"><a class="toclink" href="09/finops-for-azure-optimizing-your-cloud-spend/#references">References</a></h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=YHUptdFtozQ">Thanks John Savill</a></li>
<li><a href="https://microsoft.github.io/finops-toolkit/">FinOps toolkit</a></li>
</ul>
</div>
</article>
<nav class="md-pagination">
</nav>
</div>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2023-now Rafael Fernández
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://www.linkedin.com/in/rafaelfernandezd/" rel="noopener" target="_blank" title="LinkedIn">
<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/rfernandezdo" rel="noopener" target="_blank" title="GitHub">
<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://rfernandezdo.github.io/feed_rss_created.xml" rel="noopener" target="_blank" title="RSS feed">
<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm32 104c0-13.3 10.7-24 24-24 137 0 248 111 248 248 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200-13.3 0-24-10.7-24-24m0 96c0-13.3 10.7-24 24-24 83.9 0 152 68.1 152 152 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104-13.3 0-24-10.7-24-24m0 120a32 32 0 1 1 64 0 32 32 0 1 1-64 0"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.sections", "navigation.top", "navigation.tracking", "toc.integrate", "toc.nested", "toc.smoothscroll", "footer", "content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>